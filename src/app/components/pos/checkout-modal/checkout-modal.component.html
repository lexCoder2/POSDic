<app-modal
  [show]="show"
  [title]="'POS.CHECKOUT.TITLE' | translate"
  icon="fas fa-cash-register"
  size="lg"
  (close)="onClose()"
>
  <div class="checkout-summary">
    <div class="summary-item">
      <i class="fas fa-shopping-basket"></i>
      <span>{{ cartItems.length }} {{ "POS.CHECKOUT.ITEMS" | translate }}</span>
    </div>
    <div class="summary-item total">
      <i class="fas fa-dollar-sign"></i>
      <span>{{ total | appCurrency }}</span>
    </div>
  </div>
  <div class="payment-methods">
    <h4>
      <i class="fas fa-wallet"></i>
      {{ "POS.CHECKOUT.PAYMENT_METHOD" | translate }}
    </h4>
    <div class="payment-grid">
      <button
        class="payment-btn"
        [class.active]="paymentMethod === 'cash'"
        (click)="setPaymentMethod('cash')"
      >
        <i class="fas fa-money-bill-wave"></i>
        <span>{{ "POS.PAYMENTS.CASH" | translate }}</span>
      </button>
      <button
        class="payment-btn"
        [class.active]="paymentMethod === 'card'"
        (click)="setPaymentMethod('card')"
      >
        <i class="fas fa-credit-card"></i>
        <span>{{ "POS.PAYMENTS.CARD" | translate }}</span>
      </button>
      <button
        class="payment-btn"
        [class.active]="paymentMethod === 'transfer'"
        (click)="setPaymentMethod('transfer')"
      >
        <i class="fas fa-exchange-alt"></i>
        <span>{{ "POS.PAYMENTS.TRANSFER" | translate }}</span>
      </button>
      <button
        class="payment-btn"
        [class.active]="paymentMethod === 'mixed'"
        (click)="setPaymentMethod('mixed')"
      >
        <i class="fas fa-layer-group"></i>
        <span>{{ "POS.PAYMENTS.MIXED" | translate }}</span>
      </button>
    </div>
  </div>
  <div class="payment-amounts">
    @if (paymentMethod === "cash" || paymentMethod === "mixed") {
      <div class="amount-input">
        <label
          ><i class="fas fa-money-bill-wave"></i>
          {{ "POS.CHECKOUT.CASH_AMOUNT" | translate }}</label
        >
        <div class="input-wrapper">
          <input
            #cashInput
            type="number"
            [(ngModel)]="cashAmount"
            placeholder="0.00"
            min="0"
            step="0.01"
          />
        </div>
        @if (cashAmount > total && paymentMethod === "cash") {
          <div class="change-display">
            <i class="fas fa-hand-holding-usd"></i>
            {{ "POS.CHECKOUT.CHANGE" | translate }}
            {{ changeAmount | appCurrency }}
          </div>
        }
      </div>
    }
    @if (paymentMethod === "card" || paymentMethod === "mixed") {
      <div class="amount-input">
        <label
          ><i class="fas fa-credit-card"></i>
          {{ "POS.CHECKOUT.CARD_AMOUNT" | translate }}</label
        >
        <div class="input-wrapper">
          <input
            #cardInput
            type="number"
            [(ngModel)]="cardAmount"
            placeholder="0.00"
            min="0"
            step="0.01"
          />
        </div>
      </div>
    }
    @if (paymentMethod === "transfer" || paymentMethod === "mixed") {
      <div class="amount-input">
        <label
          ><i class="fas fa-exchange-alt"></i>
          {{ "POS.CHECKOUT.TRANSFER_AMOUNT" | translate }}</label
        >
        <div class="input-wrapper">
          <span class="currency">$</span>
          <input
            #transferInput
            type="number"
            [(ngModel)]="transferAmount"
            placeholder="0.00"
            min="0"
            step="0.01"
          />
        </div>
      </div>
    }
  </div>

  <div class="modal-footer" modal-footer>
    <button class="btn-cancel" (click)="onClose()">
      <i class="fas fa-times"></i> {{ "GLOBAL.CANCEL" | translate }}
    </button>
    <button
      class="btn-complete"
      (click)="onCompleteSale()"
      [disabled]="!validatePayment()"
    >
      <i class="fas fa-check"></i>
      {{ "POS.BUTTONS.COMPLETE_SALE" | translate }}
    </button>
  </div>
</app-modal>
